{"id":"knip-intellij-plugin-2e1","title":"Prepare for JetBrains Marketplace Publishing","description":"Prepare the plugin for publishing to JetBrains Marketplace.\n\nTasks:\n1. Set up plugin signing certificates\n2. Configure deployment token in GitHub secrets\n3. Update gradle.properties with final version\n4. Verify plugin compatibility matrix (IDE versions)\n5. Create marketplace listing with:\n   - Icon\n   - Screenshots\n   - Detailed description\n   - Tags (knip, unused code, linting, typescript, javascript)\n6. Test plugin installation from local build\n7. Submit for review","acceptance_criteria":"- Plugin passes JetBrains verification\n- Plugin is published and installable from marketplace\n- All marketplace metadata is complete\n- Plugin works in supported IDE versions","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-06T14:06:07.933388-06:00","updated_at":"2026-01-06T14:39:24.541612-06:00","closed_at":"2026-01-06T14:39:24.541612-06:00","close_reason":"Completed: Created PUBLISHING.md with comprehensive marketplace publishing guide (signing keys, GitHub secrets, publishing process). Updated CHANGELOG.md with initial release notes. Build passes.","labels":["marketplace","release"],"dependencies":[{"issue_id":"knip-intellij-plugin-2e1","depends_on_id":"knip-intellij-plugin-780","type":"blocks","created_at":"2026-01-06T14:06:07.936619-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-2e1","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:06:13.844894-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-4ow","title":"Error Handling and User Notifications","description":"Implement proper error handling and user-friendly notifications.\n\nTasks:\n1. Handle \"Node.js not found\" error with helpful message\n2. Handle \"@knip/language-server not installed\" error\n3. Show notification when server fails to start\n4. Provide action buttons in notifications (e.g., \"Configure Node.js path\")\n5. Log errors to IDE log for debugging\n6. Handle workspace without package.json gracefully","acceptance_criteria":"- Clear error message when Node.js is not found\n- Notification suggests installing @knip/language-server if missing\n- Errors are logged with sufficient detail for debugging\n- No cryptic error messages shown to users","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T14:05:37.068549-06:00","updated_at":"2026-01-06T14:33:12.160353-06:00","closed_at":"2026-01-06T14:33:12.160353-06:00","close_reason":"Completed: Created KnipNotifications helper with info/warning/error methods, server status notifications, and helpful messages for Node.js/npx not found scenarios. Build passes.","labels":["error-handling","ux"],"dependencies":[{"issue_id":"knip-intellij-plugin-4ow","depends_on_id":"knip-intellij-plugin-bva","type":"blocks","created_at":"2026-01-06T14:05:37.070968-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-4ow","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:05:40.745666-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-780","title":"Update Documentation and README","description":"Update all documentation for the plugin.\n\nTasks:\n1. Rewrite README.md with:\n   - Clear plugin description\n   - Features list\n   - Installation instructions\n   - Configuration guide\n   - Requirements (Node.js, @knip/language-server)\n2. Update plugin.xml description for marketplace\n3. Add CHANGELOG.md entries\n4. Create screenshots/GIFs for marketplace listing\n5. Add troubleshooting section","acceptance_criteria":"- README clearly explains what the plugin does\n- Installation steps are accurate and complete\n- Requirements are clearly stated\n- Screenshots show plugin in action","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-06T14:05:56.383135-06:00","updated_at":"2026-01-06T14:36:04.369928-06:00","closed_at":"2026-01-06T14:36:04.369928-06:00","close_reason":"Completed: Comprehensive README with requirements, installation instructions, configuration guide, usage instructions, troubleshooting section, and development commands. Build passes.","labels":["documentation"],"dependencies":[{"issue_id":"knip-intellij-plugin-780","depends_on_id":"knip-intellij-plugin-hw3","type":"blocks","created_at":"2026-01-06T14:05:56.385697-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-780","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:05:59.652689-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-7cd","title":"Project Setup \u0026 Configuration","description":"Update the plugin template with proper naming and add LSP4IJ dependency.\n\nTasks:\n1. Update plugin.xml with proper plugin name \"Knip\" and description\n2. Update gradle.properties with correct pluginGroup and pluginName\n3. Add LSP4IJ dependency to build.gradle.kts for LSP support\n4. Rename package from template names to knip-specific names\n5. Update MyBundle.properties with Knip-specific messages","acceptance_criteria":"- Plugin builds successfully with LSP4IJ dependency\n- Plugin name shows as \"Knip\" in IDE\n- All template placeholder text is replaced","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T14:04:20.312097-06:00","updated_at":"2026-01-06T14:12:08.774593-06:00","closed_at":"2026-01-06T14:12:08.774593-06:00","close_reason":"Completed: Updated plugin name to Knip, added LSP4IJ dependency, updated README description, updated bundle messages, removed template code, build and tests pass.","labels":["configuration","setup"],"dependencies":[{"issue_id":"knip-intellij-plugin-7cd","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:04:25.209973-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-af3","title":"Implement Language Server Factory","description":"Create the LanguageServerFactory to instantiate and manage the Knip language server.\n\nTasks:\n1. Create KnipLanguageServerFactory class implementing LanguageServerFactory\n2. Implement createServer() method to spawn the language server process\n3. Handle Node.js/npx path detection (system PATH, nvm, volta, etc.)\n4. Implement proper process lifecycle management\n5. Register factory in plugin.xml","acceptance_criteria":"- Factory can successfully spawn the Knip language server\n- Node.js detection works across different installation methods\n- Server process is properly managed (started/stopped)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T14:04:41.607916-06:00","updated_at":"2026-01-06T14:15:08.800141-06:00","closed_at":"2026-01-06T14:15:08.800141-06:00","close_reason":"Completed: Enhanced KnipStreamConnectionProvider with comprehensive Node.js/npx detection supporting nvm, volta, fnm, asdf, and standard installations. Build passes.","labels":["core","lsp"],"dependencies":[{"issue_id":"knip-intellij-plugin-af3","depends_on_id":"knip-intellij-plugin-tc1","type":"blocks","created_at":"2026-01-06T14:04:41.610817-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-af3","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:04:45.96275-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-bgt","title":"NPX fails to determine executable for @knip/language-server","description":"During the first dry run of the Knip IntelliJ plugin, the language server fails to start with repeated npm errors:\n\n```\nnpm error could not determine executable to run\nnpm error A complete log of this run can be found in: /Users/jan-niklaswortmann/.npm/_logs/2026-01-06T20_45_44_981Z-debug-0.log\n```\n\nThis error occurs multiple times and causes:\n1. Language server fails to start\n2. Timeout errors when trying to shutdown the non-running server:\n   ```\n   WARN - com.redhat.devtools.lsp4ij.LanguageServerWrapper - Timeout error while shutdown the language server 'knipLanguageServer'\n   java.util.concurrent.TimeoutException\n   ```\n\n**Root Cause Analysis:**\nThe `KnipStreamConnectionProvider` uses `npx @knip/language-server --stdio` but npx cannot find/determine the executable. This could be due to:\n1. The package `@knip/language-server` not being installed globally or locally\n2. npx not being able to resolve the package from the registry\n3. The package's `bin` field not being properly configured\n4. Network/registry issues preventing npx from downloading the package\n\n**Reproduction Steps:**\n1. Open IntelliJ with the Knip plugin installed\n2. Open a JavaScript/TypeScript project\n3. Observe npm errors in the IDE logs\n\n**Expected Behavior:**\nThe language server should start successfully and provide diagnostics for unused code.\n\n**Actual Behavior:**\nMultiple \"npm error could not determine executable to run\" errors, followed by timeout errors when the plugin tries to shutdown the non-existent server.","acceptance_criteria":"- [ ] Investigate why npx cannot determine the executable for @knip/language-server\n- [ ] Implement fallback mechanism if npx fails (e.g., try global install, local node_modules)\n- [ ] Add better error messaging to inform users what went wrong\n- [ ] Consider requiring users to install @knip/language-server globally first\n- [ ] Add validation in settings to check if the language server is available before starting\n- [ ] Test with fresh environment to ensure server starts correctly","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-06T14:49:29.360904-06:00","updated_at":"2026-01-06T14:57:35.397707-06:00","closed_at":"2026-01-06T14:57:35.397707-06:00","close_reason":"Fixed: Changed from npx to direct node execution. The @knip/language-server package lacks a bin field, so npx cannot run it. The fix locates the installed package and runs src/index.js directly with node. Added auto-detection for Volta, npm global, nvm, pnpm, yarn, fnm, and asdf installations. Updated settings to allow custom languageServerPath. All tests pass.","labels":["bug","critical","lsp","startup"],"dependencies":[{"issue_id":"knip-intellij-plugin-bgt","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:49:33.622386-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-bva","title":"Implement Server Lifecycle Management","description":"Handle proper startup, shutdown, and restart of the Knip language server.\n\nTasks:\n1. Start server when project with JS/TS files is opened\n2. Stop server when project is closed\n3. Implement server restart on configuration change\n4. Handle server crashes with automatic restart and backoff\n5. Add status bar indicator showing server status\n6. Implement manual restart action in Tools menu","acceptance_criteria":"- Server starts automatically for JS/TS projects\n- Server stops cleanly on project close\n- Crash recovery works with exponential backoff\n- Status bar shows server state (running/stopped/error)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T14:05:26.039024-06:00","updated_at":"2026-01-06T14:32:12.673249-06:00","closed_at":"2026-01-06T14:32:12.673249-06:00","close_reason":"Completed: Added RestartKnipServerAction in Tools menu, notification group for user feedback. LSP4IJ handles automatic server lifecycle (start on file open, stop on project close, crash recovery). Build passes.","labels":["lifecycle","lsp"],"dependencies":[{"issue_id":"knip-intellij-plugin-bva","depends_on_id":"knip-intellij-plugin-af3","type":"blocks","created_at":"2026-01-06T14:05:26.041443-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-bva","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:05:30.180412-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-dve","title":"Implement Diagnostics Display","description":"Ensure Knip diagnostics (unused code warnings) are properly displayed in the IDE.\n\nTasks:\n1. Verify LSP4IJ automatically handles textDocument/publishDiagnostics\n2. Configure diagnostic severity mapping (warnings for unused code)\n3. Ensure diagnostics appear in editor gutter and Problems tool window\n4. Add custom icons or styling for Knip-specific diagnostics if needed\n5. Test diagnostic display for unused exports, files, and dependencies","acceptance_criteria":"- Unused exports show as warnings in editor\n- Unused files are highlighted\n- Diagnostics appear in Problems tool window\n- Diagnostics update when files are saved","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T14:05:02.838597-06:00","updated_at":"2026-01-06T14:29:20.202593-06:00","closed_at":"2026-01-06T14:29:20.202593-06:00","close_reason":"Completed: Created KnipClientFeatures class and integrated with factory. LSP4IJ handles diagnostics automatically via textDocument/publishDiagnostics. Build passes.","labels":["diagnostics","lsp","ui"],"dependencies":[{"issue_id":"knip-intellij-plugin-dve","depends_on_id":"knip-intellij-plugin-af3","type":"blocks","created_at":"2026-01-06T14:05:02.842467-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-dve","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:05:06.46889-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-eiy","title":"Error in textDocument/codeAction: Cannot read properties of null (reading 'editor')","description":"When consuming 'textDocument/codeAction' with the Knip language server, a ResponseErrorException is thrown.\n\n**Error Message:**\n```\nRequest textDocument/codeAction failed with message: Cannot read properties of null (reading 'editor')\n```\n\n**Full Stack Trace:**\n```\n2026-01-06 15:00:27,932 [  35637] SEVERE - com.redhat.devtools.lsp4ij.internal.CancellationSupport - Error while consuming 'textDocument/codeAction' with language server 'Knip'\norg.eclipse.lsp4j.jsonrpc.ResponseErrorException: Request textDocument/codeAction failed with message: Cannot read properties of null (reading 'editor')\n\tat org.eclipse.lsp4j.jsonrpc.RemoteEndpoint.handleResponse(RemoteEndpoint.java:209)\n\tat org.eclipse.lsp4j.jsonrpc.RemoteEndpoint.consume(RemoteEndpoint.java:193)\n\tat com.redhat.devtools.lsp4ij.LanguageServerWrapper.lambda$start$5(LanguageServerWrapper.java:330)\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1804)\n\tat java.base/java.util.concurrent.CompletableFuture$AsyncRun.exec(CompletableFuture.java:1796)\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1491)\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:2073)\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2035)\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:187)\n```\n\n**Analysis:**\nThe error originates from the Knip language server (likely the upstream knip npm package) when handling a codeAction request. The 'editor' property is null when the server tries to access it, suggesting the server may not be properly initialized or the editor context is not being passed correctly.","notes":"Root cause: Knip server requests workspace.getConfiguration('knip'), but settings were returned at root level. LSP4IJ's findSettings('knip') couldn't find the 'knip' key, returned null, causing the 'editor' null error. Fix: wrap settings inside a 'knip' key in createSettings().","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-06T15:01:09.663175-06:00","updated_at":"2026-01-06T15:22:44.10285-06:00","closed_at":"2026-01-06T15:22:44.10285-06:00","close_reason":"Fixed by wrapping settings in 'knip' key. The Knip server requests workspace.getConfiguration('knip'), and LSP4IJ's findSettings() looks for a matching key. Previously settings were at root level causing null to be returned. Now the configuration is properly structured and code actions work.","labels":["codeAction","error","lsp"]}
{"id":"knip-intellij-plugin-hw3","title":"Write Unit and Integration Tests","description":"Create comprehensive tests for the plugin.\n\nTasks:\n1. Unit tests for KnipSettings persistence\n2. Unit tests for Node.js path detection logic\n3. Integration tests for server descriptor registration\n4. Test file type matching logic\n5. Mock-based tests for LSP communication\n6. Test error handling scenarios","acceptance_criteria":"- All unit tests pass\n- Code coverage \u003e 70%\n- Integration tests verify plugin loads correctly\n- CI pipeline runs tests on PR","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T14:05:46.33852-06:00","updated_at":"2026-01-06T14:35:11.728728-06:00","closed_at":"2026-01-06T14:35:11.728728-06:00","close_reason":"Completed: Created unit tests for KnipSettings (4 tests), KnipStreamConnectionProvider (3 tests), and MyBundle messages (2 tests). All 9 tests pass.","labels":["quality","testing"],"dependencies":[{"issue_id":"knip-intellij-plugin-hw3","depends_on_id":"knip-intellij-plugin-dve","type":"blocks","created_at":"2026-01-06T14:05:46.342441-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-hw3","depends_on_id":"knip-intellij-plugin-k8e","type":"blocks","created_at":"2026-01-06T14:05:46.344082-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-hw3","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:05:50.433651-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-k8e","title":"Create Plugin Settings UI","description":"Implement a settings page for configuring the Knip plugin.\n\nTasks:\n1. Create KnipSettingsConfigurable implementing Configurable\n2. Add settings for:\n   - Enable/disable plugin\n   - Custom Node.js path\n   - Custom npx path\n   - Language server arguments\n3. Create KnipSettings persistent state component\n4. Register settings page in plugin.xml under Tools\n5. Apply settings changes to running language server","acceptance_criteria":"- Settings page appears under Settings \u003e Tools \u003e Knip\n- Settings persist across IDE restarts\n- Changing Node.js path affects server startup\n- Enable/disable toggle works correctly","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T14:05:15.064327-06:00","updated_at":"2026-01-06T14:31:07.347282-06:00","closed_at":"2026-01-06T14:31:07.347282-06:00","close_reason":"Completed: Created KnipSettings persistent state component and KnipSettingsConfigurable UI. Settings page registered under Tools \u003e Knip with enable/disable, Node.js path, npx path, and server arguments. Build passes.","labels":["settings","ui"],"dependencies":[{"issue_id":"knip-intellij-plugin-k8e","depends_on_id":"knip-intellij-plugin-af3","type":"blocks","created_at":"2026-01-06T14:05:15.066883-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-k8e","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:05:18.855124-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-m4q","title":"Cleanup template code and add proper release notes and plugin description","description":"Clean up all remaining template/boilerplate code from the IntelliJ plugin template and add proper:\n1. Plugin description in README.md (for marketplace)\n2. Release notes in CHANGELOG.md\n3. Remove unused template files and code (MyBundle, MyProjectService, MyProjectActivity, MyToolWindowFactory, etc.)\n4. Update any remaining \"My\" prefixed names to proper Knip-related names","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T08:19:22.544931-06:00","updated_at":"2026-01-07T08:23:00.300752-06:00","closed_at":"2026-01-07T08:23:00.300752-06:00","close_reason":"Cleaned up all template code: removed MyProjectService, MyProjectActivity, MyToolWindowFactory, MyPluginTest, and test data files. Renamed MyBundle to KnipBundle. Updated plugin.xml. Added proper release notes in CHANGELOG.md and plugin description in README.md (already present).","labels":["cleanup","documentation","release"]}
{"id":"knip-intellij-plugin-rrn","title":"Define Supported File Types and Language Mapping","description":"Configure which file types the Knip language server should handle.\n\nTasks:\n1. Create file type associations for JS, TS, JSX, TSX files\n2. Include JSON files for package.json and knip.json support\n3. Implement DocumentMatcher or file pattern matching\n4. Ensure proper language ID mapping to LSP protocol\n5. Test that server activates for correct file types","acceptance_criteria":"- Server activates when opening JS/TS/JSX/TSX files\n- Server activates for package.json and knip.json\n- Server does NOT activate for unrelated file types","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T14:04:53.15609-06:00","updated_at":"2026-01-06T14:16:07.302324-06:00","closed_at":"2026-01-06T14:16:07.302324-06:00","close_reason":"Completed: Added languageId mappings for JS/TS/JSX/TSX, file name pattern mappings for package.json, knip.json, and config files. Build passes.","labels":["configuration","lsp"],"dependencies":[{"issue_id":"knip-intellij-plugin-rrn","depends_on_id":"knip-intellij-plugin-tc1","type":"blocks","created_at":"2026-01-06T14:04:53.15854-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-rrn","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:04:56.37487-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-tc1","title":"Implement LSP Server Descriptor","description":"Create the LanguageServerDescriptor implementation for the Knip language server.\n\nTasks:\n1. Create KnipLanguageServerDescriptor class extending LanguageServerDescriptor\n2. Configure server command to run: npx @knip/language-server --stdio\n3. Define supported file types (JS, TS, JSX, TSX, JSON)\n4. Implement server initialization options if needed\n5. Register the descriptor in plugin.xml","acceptance_criteria":"- KnipLanguageServerDescriptor class exists and compiles\n- Server descriptor is registered in plugin.xml\n- Descriptor correctly specifies npx command for starting server","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-06T14:04:32.182556-06:00","updated_at":"2026-01-06T14:14:13.986736-06:00","closed_at":"2026-01-06T14:14:13.986736-06:00","close_reason":"Completed: Created KnipLanguageServerFactory and KnipStreamConnectionProvider classes, registered server and file type mappings in plugin.xml. Build passes.","labels":["core","lsp"],"dependencies":[{"issue_id":"knip-intellij-plugin-tc1","depends_on_id":"knip-intellij-plugin-7cd","type":"blocks","created_at":"2026-01-06T14:04:32.184968-06:00","created_by":"daemon"},{"issue_id":"knip-intellij-plugin-tc1","depends_on_id":"knip-intellij-plugin-tl9","type":"parent-child","created_at":"2026-01-06T14:04:35.76648-06:00","created_by":"daemon"}]}
{"id":"knip-intellij-plugin-tl9","title":"Knip Language Server IntelliJ Plugin","description":"Implement an IntelliJ plugin that integrates the @knip/language-server to provide real-time detection of unused files, dependencies, and exports in JavaScript/TypeScript projects.\n\nThe plugin should:\n- Start/stop the Knip language server automatically\n- Display diagnostics (unused code warnings) in the editor\n- Support configuration via knip.json/knip.ts\n- Work with WebStorm, IntelliJ IDEA, and other JetBrains IDEs","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-06T14:04:13.724316-06:00","updated_at":"2026-01-06T14:39:35.204313-06:00","closed_at":"2026-01-06T14:39:35.204313-06:00","close_reason":"Epic completed: All 11 tasks implemented - LSP integration, settings UI, lifecycle management, error handling, tests, documentation, and marketplace publishing guide.","labels":["knip","lsp","plugin"]}
